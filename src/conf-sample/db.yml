auth:
    dbname: mysqldb
    host: localhost
    password: 'mysqlpass'
    port: 3306
    user: 'mysqluser'
sql:
  globalstats:
    total_users_registered:
      desc: "Number of registered users"
      name: "Total Users Registered"
      query: "SELECT COUNT(username) AS total_users FROM users"
      type: line
    total_tippers:
      desc: "Number of users who tipped at least once"
      name: "Total Tippers"
      type: line
      query: "SELECT COUNT(DISTINCT source) as total_tippers FROM actions WHERE action = 'tip' AND status = 'completed'"
    total_tips:
      name: "Total Number of Tips"
      desc: "Total number of tips given"
      query: "SELECT COUNT(1) AS total_tips FROM actions WHERE action = 'tip' AND status = 'completed'"
      type: line
  history: "SELECT message_timestamp AS `when`, action, source, destination, amount, path AS comment, status FROM actions WHERE action IN ('tip', 'withdraw') AND (destination=%s OR source=%s) ORDER BY message_timestamp DESC LIMIT 75"
  tips:
    limit: 10000
    sql_list: "SELECT @rank :=@rank+1 AS num, created_utc, from_user, to_user, coin_val, coin, subreddit, msg_link FROM t_action WHERE type='givetip' AND state='completed' ORDER BY created_utc ASC LIMIT %s"
    sql_set: "SET @rank=0"
  userstats:
    history: "SELECT action, amount, destination, message_timestamp, source, status FROM actions WHERE action IN ('tip', 'withdraw') AND (destination=%s OR source=%s) ORDER BY message_timestamp"
    total_received: "SELECT SUM(amount) AS total FROM actions WHERE action='tip' AND destination=%s AND state='completed'"
    total_tipped: "SELECT SUM(amount) AS total FROM actions WHERE action='tip' AND source=%s AND state='completed'"
    users: "SELECT source AS username FROM actions WHERE action = 'tip' UNION SELECT destination AS username FROM actions WHERE action = 'tip' ORDER BY username"
